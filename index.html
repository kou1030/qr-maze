<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å­¦ç¥­è¿·è·¯ã‚²ãƒ¼ãƒ </title>
  <style>
    body { font-family: sans-serif; text-align: center; margin: 40px; }
    #game { margin-top: 20px; }
    #timer { font-size: 18px; margin-top: 10px; }
    #inventory { margin-top: 20px; font-size: 16px; text-align: left; display: inline-block; }
    button { padding: 10px 20px; margin: 10px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>å­¦ç¥­è¿·è·¯ã‚²ãƒ¼ãƒ </h1>
  <div id="game"></div>
  <div id="timer"></div>
  <div id="inventory"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const gameDiv = document.getElementById("game");
    const timerDiv = document.getElementById("timer");
    const inventoryDiv = document.getElementById("inventory");

    let startTime;
    let timerInterval;
    let keywords = [];
    let items = [];
    let coins = 0;

    function updateInventory() {
      let html = "<h3>ç²å¾—çŠ¶æ³</h3><ul>";
      keywords.forEach(k => html += `<li>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${k}</li>`);
      items.forEach(i => html += `<li>ã‚¢ã‚¤ãƒ†ãƒ : ${i}</li>`);
      html += `<li>ã‚³ã‚¤ãƒ³: ${coins}</li>`;
      html += "</ul>";
      inventoryDiv.innerHTML = html;
    }

    function startTimer() {
      startTime = Date.now();
      gameDiv.innerHTML = "<p>ã‚¿ã‚¤ãƒãƒ¼ãŒã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã—ãŸï¼è¿·è·¯ã«æŒ‘æˆ¦ï¼</p>";
      updateInventory();
      timerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        const minutes = Math.floor(elapsed / 60);
        const seconds = elapsed % 60;
        timerDiv.textContent = `çµŒéæ™‚é–“: ${minutes}åˆ† ${seconds}ç§’`;
      }, 1000);
    }

    function showQuiz(num) {
      let quizHTML = "";
      if(num === "1"){
        quizHTML = `
          <h2>ã‚¯ã‚¤ã‚º1</h2>
          <p>å¤§å­¦ç¥­ã¯ä½•æœˆã«é–‹å‚¬ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ï¼Ÿ</p>
          <button onclick="answer('quiz1', true)">10æœˆã€œ11æœˆ</button>
          <button onclick="answer('quiz1', false)">1æœˆ</button>
        `;
      } else if(num === "2"){
        quizHTML = `
          <h2>ã‚¯ã‚¤ã‚º2</h2>
          <p>QRã‚³ãƒ¼ãƒ‰ã‚’ç™ºæ˜ã—ãŸã®ã¯ã©ã“ã®å›½ï¼Ÿ</p>
          <button onclick="answer('quiz2', true)">æ—¥æœ¬</button>
          <button onclick="answer('quiz2', false)">ã‚¢ãƒ¡ãƒªã‚«</button>
        `;
      } else if(num === "3"){
        quizHTML = `
          <h2>ã‚¯ã‚¤ã‚º3</h2>
          <p>æ¬¡ã®ã†ã¡ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¯ã©ã‚Œï¼Ÿ</p>
          <button onclick="answer('quiz3', true)">JavaScript</button>
          <button onclick="answer('quiz3', false)">Photoshop</button>
        `;
      }
      gameDiv.innerHTML = quizHTML;
      updateInventory();
    }

    function answer(quiz, correct){
      if(correct){
        alert("æ­£è§£ï¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç²å¾—ã—ã¾ã—ãŸğŸ‰");
        if(quiz === "quiz1") keywords.push("ç¥­ã®æœˆ");
        if(quiz === "quiz2") items.push("QRã®çŸ¥è­˜");
        if(quiz === "quiz3") keywords.push("ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°");
        updateInventory();
        gameDiv.innerHTML = "<p>æ¬¡ã®QRã‚³ãƒ¼ãƒ‰ã‚’æ¢ãã†ï¼</p>";
      } else {
        alert("ä¸æ­£è§£â€¦ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ã¿ã¦ã­ã€‚");
      }
    }

    function collectItem(name){
      items.push(name);
      alert(`ã‚¢ã‚¤ãƒ†ãƒ ã€Œ${name}ã€ã‚’ç²å¾—ã—ã¾ã—ãŸï¼`);
      updateInventory();
    }

    function collectCoin(){
      coins += 1;
      alert(`ã‚³ã‚¤ãƒ³ã‚’ç²å¾—ï¼ ç¾åœ¨ã®ã‚³ã‚¤ãƒ³æ•°: ${coins}`);
      updateInventory();
    }

    function showPuzzle(){
      if(items.includes("QRã®çŸ¥è­˜")){
        alert("è¬è§£ãæˆåŠŸï¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€Œãƒ‘ã‚ºãƒ«ã®ç­”ãˆã€ã‚’ç²å¾—ï¼");
        keywords.push("ãƒ‘ã‚ºãƒ«ã®ç­”ãˆ");
        updateInventory();
      } else {
        alert("è¬è§£ãå¤±æ•—â€¦å¯¾å¿œã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ãŒå¿…è¦ã§ã™");
      }
    }

    function showGoal(){
      if(!keywords.includes("ç¥­ã®æœˆ") || !keywords.includes("ãƒ‘ã‚ºãƒ«ã®ç­”ãˆ")){
        gameDiv.innerHTML = "<p>ã¾ã å¿…è¦ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’é›†ã‚ã¦ã„ã¾ã›ã‚“ï¼</p>";
        updateInventory();
        return;
      }
      clearInterval(timerInterval);
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      gameDiv.innerHTML = `<h2>ã‚´ãƒ¼ãƒ«ï¼</h2><p>ã‚¯ãƒªã‚¢ã‚¿ã‚¤ãƒ : ${minutes}åˆ† ${seconds}ç§’</p>`;
      updateInventory();
      timerDiv.textContent = "";
    }

    // URLãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    if(params.has("s")) startTimer();
    else if(params.has("q")){
      const q = params.get("q");
      if(q === "1" || q === "2" || q === "3") showQuiz(q);
      else if(q === "item") collectItem("ãŠå®ã‚¢ã‚¤ãƒ†ãƒ ");
      else if(q === "coin") collectCoin();
      else if(q === "puzzle") showPuzzle();
    }
    else if(params.has("goal")) showGoal();
    else{
      gameDiv.innerHTML = "<p>ã‚¹ã‚¿ãƒ¼ãƒˆQRã‚’èª­ã¿å–ã£ã¦ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã¦ãã ã•ã„</p>";
      updateInventory();
    }

  </script>
</body>
</html>
